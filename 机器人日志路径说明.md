# 机器人日志路径说明

## 问题描述

使用 `./deploy` 部署机器人后，在开发机器的 `Config/Logs` 目录下没有看到日志文件。

## 原因分析

### 1. 日志路径差异

- **SimRobot 模拟器**：日志写入到 `<项目目录>/Config/Logs/`
- **真实机器人**：日志写入到 `/home/nao/logs/`

### 2. 为什么不同？

在 `Install/createHomeArchive` 脚本中，部署时会：
```bash
# 创建 /home/nao/logs 目录
mkdir -p "${homeDir}/nao/logs"

# 同步 Config 目录，但排除 Logs 子目录
rsync --del --exclude=/Logs ... "${bhDir}/Config/." "${homeDir}/nao/Config"
```

这意味着：
- 机器人上有 `/home/nao/logs` 目录（用于存放日志）
- 机器人上**没有** `/home/nao/Config/Logs` 目录
- `File::getBHDir()` 在真实机器人上返回 `"."` (即 `/home/nao/`)

## 解决方案

已修改 `TeamMessageHandler.cpp`，使用条件编译区分路径：

```cpp
#ifdef TARGET_ROBOT
  // 真实机器人：使用 /home/nao/logs 目录
  std::string logDir = std::string(File::getBHDir()) + "/logs/" + matchFolder.str() + "/" + teamFolder + "/";
#else
  // 模拟器：使用 Config/Logs 目录
  std::string logDir = std::string(File::getBHDir()) + "/Config/Logs/" + matchFolder.str() + "/" + teamFolder + "/";
#endif
```

## 日志文件位置

### 模拟器（SimRobot）
```
<项目目录>/Config/Logs/YYYYMMDD_HHMMSS/Team70/team_comm_p1.txt
```

### 真实机器人
```
/home/nao/logs/YYYYMMDD_HHMMSS/Team70/team_comm_p1.txt
```

## 如何查看机器人上的日志

### 方法 1：SSH 登录查看
```bash
# SSH 登录到机器人
ssh nao@10.0.70.6

# 查看日志目录
ls -la /home/nao/logs/

# 查看最新的日志
cd /home/nao/logs/
ls -lt | head -5

# 查看具体日志文件
cat /home/nao/logs/20260127_223000/Team70/team_comm_p1.txt
```

### 方法 2：使用 SCP 下载日志
```bash
# 下载整个日志目录
scp -r nao@10.0.70.6:/home/nao/logs/ ./robot_logs/

# 下载特定日期的日志
scp -r nao@10.0.70.6:/home/nao/logs/20260127_223000/ ./robot_logs/
```

### 方法 3：使用 copyLogs 脚本
```bash
# 使用项目提供的脚本
cd Make/Common
./copyLogs -r 10.0.70.6
```

## 日志文件格式

日志文件包含以下信息：
```
========================================
团队通信日志
比赛时间: 2026-01-27 22:30:00
队伍编号: 70
机器人编号: 1
========================================

[发送] 时间=12345ms
  机器人: 1号
  位置: (1000, 500) 朝向=0.5
  球: (200, 100) 可见度=80%
  角色: striker
  传球目标: 2 | 行走目标: (300,200)
  消息预算剩余: 1150

[接收] 时间=12350ms 来自机器人2号
  位置: (-1000, 500) 朝向=-0.5
  球: (150, 80) 可见度=75%
  角色: supporter
  传球目标: -1 | 行走目标: (0,0)
```

## 注意事项

1. **重新编译**：修改后需要重新编译并部署到机器人
   ```bash
   # 编译
   cd Make/Linux
   make Nao
   
   # 部署
   cd ../..
   ./deploy -r 1 10.0.70.6 -nc -t 70 -s Default -m 70 -w SPL_A -v 100 -b
   ```

2. **磁盘空间**：日志文件会占用空间，定期清理旧日志
   ```bash
   # 在机器人上清理旧日志
   ssh nao@10.0.70.6 "rm -rf /home/nao/logs/202601*"
   ```

3. **权限问题**：确保 nao 用户有写入 `/home/nao/logs` 的权限（默认应该有）

4. **时间戳**：日志文件名使用机器人的本地时间，确保机器人时间设置正确
